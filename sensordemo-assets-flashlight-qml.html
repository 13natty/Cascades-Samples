<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Cascades : flashlight.qml Example File (SensorDemo/assets/flashlight.qml)</title>
  <link rel="stylesheet" type="text/css" href="style/offline.css" />
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="content"> 
    <a href="index.html" class="qtref"><span>Qt-based BB10 API Examples Documentation</span></a>
  </div>
  <div class="breadcrumb toolblock">
    <ul>
      <li class="first"><a href="index.html">Home</a></li>
      <!--  Breadcrumbs go here -->
    </ul>
  </div>
</div>
<div class="content mainContent">
<h1 class="title">flashlight.qml Example File</h1>
<span class="small-subtitle">SensorDemo/assets/flashlight.qml</span>
<!-- $$$SensorDemo/assets/flashlight.qml-description -->
<div class="descr"> <a name="details"></a>
<pre class="qml">    <span class="comment">/* Copyright (c) 2012 Research In Motion Limited.
    *
    * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    */</span>

    import bb.cascades 1.0
    import QtMobility.sensors 1.2
    import Flashlight 1.0

    <span class="type">Container</span> {
        <span class="name">topPadding</span>: <span class="number">20</span>
        <span class="name">leftPadding</span>: <span class="number">20</span>
        <span class="name">rightPadding</span>: <span class="number">20</span>

        <span class="name">attachedObjects</span>: [
            <span class="type">Flashlight</span> {
                <span class="name">id</span>: <span class="name">flashlight</span>
            },

            <span class="type">Gyroscope</span> {
                <span class="name">id</span>: <span class="name">accel</span>

                <span class="comment">// Create a variable to count the number of sensor readings</span>
                property <span class="type">int</span> <span class="name">count</span>: <span class="number">0</span>

                <span class="comment">// Turn on the sensor</span>
                <span class="name">active</span>: <span class="number">true</span>

                <span class="comment">// Don't change sensor axis on screen rotation</span>
                <span class="name">axesOrientationMode</span>: <span class="name">Gyroscope</span>.<span class="name">FixedOrientation</span>

                <span class="comment">// Keep the sensor active when the app isn't visible or the screen is off (requires app permission in bar-descriptor)</span>
                <span class="name">alwaysOn</span>: <span class="number">true</span>

                <span class="comment">// If the device isn't moving (x&amp;y&amp;z==0), don't send updates, saves power</span>
                <span class="name">skipDuplicates</span>: <span class="number">true</span>

                <span class="name">onReadingChanged</span>: { <span class="comment">// Called when a gyroscope reading is available</span>
                    <span class="comment">// Check whether rotation on Z axis is above the configured threshold</span>
                    <span class="keyword">if</span> (<span class="name">reading</span>.<span class="name">z</span> <span class="operator">&gt;</span> <span class="name">gyroSlider</span>.<span class="name">value</span>.<span class="name">toFixed</span>() <span class="operator">*</span> <span class="number">360</span> <span class="operator">/</span> (<span class="number">2</span> <span class="operator">*</span> <span class="number">3.14</span>)) {
                        <span class="keyword">if</span> (<span class="name">count</span> <span class="operator">&gt;</span> <span class="number">5</span> <span class="operator">&amp;&amp;</span> <span class="name">ambLight</span>.<span class="name">val</span> <span class="operator">&lt;</span> <span class="name">lightDropDown</span>.<span class="name">selectedIndex</span>) {
                            <span class="comment">// If after 5 readings the ambient light is darker than the configured threshold, toggle the flash light</span>
                            <span class="name">count</span> <span class="operator">=</span> <span class="number">0</span>
                            <span class="name">flashlight</span>.<span class="name">enabled</span> <span class="operator">=</span> ! <span class="name">flashlight</span>.<span class="name">enabled</span>;
                        }
                    }
                    count ++;
                }
            },

            <span class="type">AmbientLightSensor</span> {
                <span class="name">id</span>: <span class="name">ambLight</span>

                <span class="comment">// Create a variable to hold the ambient light value</span>
                property <span class="type">variant</span> <span class="name">val</span>: <span class="name">AmbientLightSensor</span>.<span class="name">Undefined</span>

                <span class="comment">// Turn on the sensor</span>
                <span class="name">active</span>: <span class="number">true</span>

                <span class="comment">// Keep the sensor active when the app isn't visible or the screen is off (requires app permission in bar-descriptor)</span>
                <span class="name">alwaysOn</span>: <span class="number">true</span>

                <span class="comment">// If the device isn't moving (x&amp;y&amp;z==0), don't send updates, saves power</span>
                <span class="name">skipDuplicates</span>: <span class="number">true</span>

                <span class="name">onReadingChanged</span>: { <span class="comment">// Called when an ambient light reading is available</span>
                    <span class="name">val</span> <span class="operator">=</span> <span class="name">reading</span>.<span class="name">lightLevel</span>;
                    <span class="keyword">if</span> (<span class="name">ambLight</span>.<span class="name">val</span> <span class="operator">&gt;=</span> <span class="name">lightDropDown</span>.<span class="name">selectedIndex</span> <span class="operator">&amp;&amp;</span> <span class="name">flashlight</span>.<span class="name">enabled</span>) {
                        <span class="comment">// Switch off the flash light if current ambient light is brigther than configured threshold</span>
                        <span class="name">flashlight</span>.<span class="name">enabled</span> <span class="operator">=</span> <span class="number">false</span>;
                    }
                }
            },

            <span class="type">LightSensor</span> {
                <span class="name">id</span>: <span class="name">light</span>

                <span class="comment">// Create a variable to hold the ambient light value</span>
                property <span class="type">real</span> <span class="name">val</span>: <span class="number">0</span>

                <span class="comment">// Turn on the sensor</span>
                <span class="name">active</span>: <span class="number">true</span>

                <span class="comment">// Keep the sensor active when the app isn't visible or the screen is off (requires app permission in bar-descriptor)</span>
                <span class="name">alwaysOn</span>: <span class="number">true</span>

                <span class="comment">// If the device isn't moving (x&amp;y&amp;z==0), don't send updates, saves power</span>
                <span class="name">skipDuplicates</span>: <span class="number">true</span>

                <span class="name">onReadingChanged</span>: { <span class="comment">// Called when an light reading is available</span>
                    <span class="name">val</span> <span class="operator">=</span> <span class="name">reading</span>.<span class="name">lux</span>;
                }
            }
        ]

        <span class="type">TextArea</span> {
            <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;To enable the flash light give the device a clockwise flick with an angular velocity greater then 'Gyro Threshold'. The flashlight is only enabled in environments darker then 'Light Threshold'. The flashlight will automatically turn off in enviroments brighter then 'Light Threshold'.&quot;</span>)
        }

        <span class="type">Label</span> {
            <span class="name">text</span>: {
                <span class="keyword">if</span> (<span class="name">light</span>.<span class="name">val</span> <span class="operator">==</span> <span class="name">AmbientLightReading</span>.<span class="name">Dark</span>) {
                    <span class="keyword">return</span> <span class="name">qsTr</span>(<span class="string">&quot;Light: Dark&quot;</span>);
                } else <span class="keyword">if</span> (<span class="name">light</span>.<span class="name">val</span> <span class="operator">==</span> <span class="name">AmbientLightReading</span>.<span class="name">Twilight</span>) {
                    <span class="keyword">return</span> <span class="name">qsTr</span>(<span class="string">&quot;Light: Twilight&quot;</span>);
                } else <span class="keyword">if</span> (<span class="name">light</span>.<span class="name">val</span> <span class="operator">==</span> <span class="name">AmbientLightReading</span>.<span class="name">Light</span>) {
                    <span class="keyword">return</span> <span class="name">qsTr</span>(<span class="string">&quot;Light: Light&quot;</span>);
                } else <span class="keyword">if</span> (<span class="name">light</span>.<span class="name">val</span> <span class="operator">==</span> <span class="name">AmbientLightReading</span>.<span class="name">Bright</span>) {
                    <span class="keyword">return</span> <span class="name">qsTr</span>(<span class="string">&quot;Light: Bright&quot;</span>);
                } else <span class="keyword">if</span> (<span class="name">light</span>.<span class="name">val</span> <span class="operator">==</span> <span class="name">AmbientLightReading</span>.<span class="name">Sunny</span>) {
                    <span class="keyword">return</span> <span class="name">qsTr</span>(<span class="string">&quot;Light: Sunny&quot;</span>);
                } else {
                    <span class="keyword">return</span> <span class="name">qsTr</span>(<span class="string">&quot;Light: Undefined&quot;</span>);
                }
            }
        }

        <span class="type">DropDown</span> {
            <span class="name">id</span>: <span class="name">lightDropDown</span>
            <span class="name">title</span>: <span class="name">qsTr</span>(<span class="string">&quot;Light Threshold&quot;</span>)

            <span class="type">Option</span> {
                <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Undefined&quot;</span>)
            }
            <span class="type">Option</span> {
                <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Dark&quot;</span>)
            }
            <span class="type">Option</span> {
                <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Twilight&quot;</span>)
                <span class="name">selected</span>: <span class="number">true</span>
            }
            <span class="type">Option</span> {
                <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Light&quot;</span>)
            }
            <span class="type">Option</span> {
                <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Bright&quot;</span>)
            }
            <span class="type">Option</span> {
                <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Sunny&quot;</span>)
            }
        }

        <span class="type">Label</span> {
            <span class="name">topMargin</span>: <span class="number">50</span>

            <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Gyro Threshold: %1&quot;</span>).<span class="name">arg</span>(<span class="name">gyroSlider</span>.<span class="name">value</span>.<span class="name">toFixed</span>())
        }

        <span class="type">Slider</span> {
            <span class="name">id</span>: <span class="name">gyroSlider</span>
            <span class="name">value</span>: <span class="number">10</span>
            <span class="name">fromValue</span>: <span class="number">0</span>
            <span class="name">toValue</span>: <span class="number">50</span>
        }

        <span class="type">Label</span> {
            <span class="name">horizontalAlignment</span>: <span class="name">HorizontalAlignment</span>.<span class="name">Center</span>

            <span class="name">text</span>: <span class="name">qsTr</span>(<span class="string">&quot;Luminosity: %1 lux&quot;</span>).<span class="name">arg</span>(<span class="name">Math</span>.<span class="name">round</span>(<span class="name">light</span>.<span class="name">val</span>))
            <span class="type">textStyle</span> {
                <span class="name">base</span>: <span class="name">SystemDefaults</span>.<span class="name">TextStyles</span>.<span class="name">TitleText</span>
                <span class="name">color</span>: <span class="name">Color</span>.<span class="name">White</span>
                <span class="name">lineHeight</span>: <span class="number">2</span>
            }
        }
    }</pre>
</div>
<!-- @@@SensorDemo/assets/flashlight.qml -->
  <div class="ft">
    <span></span>
  </div>
</div> 
<div class="footer">
  <p>
     Copyright 2012 Research In Motion Limited.
  <br />
    This document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
    Free Documentation License version 1.3</a>
    as published by the Free Software Foundation.</p>
</div>
</body>
</html>
