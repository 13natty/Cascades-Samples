<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Cascades : QueryExec.cpp Example File (datamanagerusage/src/default/QueryExec.cpp)</title>
  <link rel="stylesheet" type="text/css" href="style/offline.css" />
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="content"> 
    <a href="index.html" class="qtref"><span>Qt-based BB10 API Examples Documentation</span></a>
  </div>
  <div class="breadcrumb toolblock">
    <ul>
      <li class="first"><a href="index.html">Home</a></li>
      <!--  Breadcrumbs go here -->
    </ul>
  </div>
</div>
<div class="content mainContent">
<h1 class="title">QueryExec.cpp Example File</h1>
<span class="small-subtitle">datamanagerusage/src/default/QueryExec.cpp</span>
<!-- $$$datamanagerusage/src/default/QueryExec.cpp-description -->
<div class="descr"> <a name="details"></a>
<pre class="cpp">    <span class="comment">/*
     * Copyright (c) 2013 BlackBerry Limited.
     *
     * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */</span>
    <span class="preprocessor">#include &quot;QueryExec.hpp&quot;</span>
    <span class="preprocessor">#include &lt;bb/cascades/datamanager/SqlQueryUtils&gt;</span>
    <span class="preprocessor">#include &lt;bb/UIToolkitSupport&gt;</span>
    <span class="preprocessor">#include &lt;QDebug&gt;</span>
    <span class="preprocessor">#include &lt;QtSql/QSqlError&gt;</span>
    <span class="preprocessor">#include &lt;QtSql/QSqlRecord&gt;</span>
    <span class="preprocessor">#include &lt;QtSql/QSqlQuery&gt;</span>

    <span class="comment">//using namespace bb::data;</span>

    <span class="comment">//used for import of the QueryExec module into QML</span>
    <span class="keyword">static</span> <span class="keyword">const</span> <span class="type">char</span> <span class="operator">*</span>MODULE_NAME <span class="operator">=</span> <span class="string">&quot;bb.cascades.datamanager&quot;</span>;
    <span class="keyword">static</span> <span class="keyword">const</span> <span class="type">int</span> MAJOR_VERSION <span class="operator">=</span> <span class="number">1</span>;
    <span class="keyword">static</span> <span class="keyword">const</span> <span class="type">int</span> MINOR_VERSION <span class="operator">=</span> <span class="number">2</span>;

    <span class="comment">//used for naming the query parameters</span>
    <span class="keyword">static</span> <span class="keyword">const</span> <span class="type">char</span> <span class="operator">*</span>QUERIES_KEY <span class="operator">=</span> <span class="string">&quot;Q&quot;</span>;
    <span class="keyword">static</span> <span class="keyword">const</span> <span class="type">char</span> <span class="operator">*</span>VALUES_KEY <span class="operator">=</span> <span class="string">&quot;V&quot;</span>;

    QueryExec<span class="operator">::</span>QueryExec(<span class="type"><a href="http://qt.nokia.com/doc/4.7/qobject.html">QObject</a></span> <span class="operator">*</span>parent) :
            <span class="type"><a href="http://qt.nokia.com/doc/4.7/qobject.html">QObject</a></span>(parent)<span class="operator">,</span> m_times(<span class="number">1</span>)<span class="operator">,</span> m_interval(<span class="number">1000</span>)<span class="operator">,</span> m_executionCount(<span class="number">0</span>)<span class="operator">,</span> m_asyncSql(NULL)<span class="operator">,</span> m_timer(NULL) {
    }

    QueryExec<span class="operator">::</span><span class="operator">~</span>QueryExec() {
        <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qDebug">qDebug</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;QueryExec destructor&quot;</span>;
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>registerQmlTypes() {
        qmlRegisterType<span class="operator">&lt;</span>QueryExec<span class="operator">&gt;</span>(MODULE_NAME<span class="operator">,</span> MAJOR_VERSION<span class="operator">,</span> MINOR_VERSION<span class="operator">,</span> <span class="string">&quot;QueryExec&quot;</span>);
    }

    <span class="comment">/**********************************************************
      *Property getters and setters.
     */</span>
    <span class="type"><a href="http://qt.nokia.com/doc/4.7/qurl.html">QUrl</a></span> QueryExec<span class="operator">::</span>source() <span class="keyword">const</span> {
        <span class="keyword">return</span> m_source;
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>setSource(<span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>newSource) {
        m_source <span class="operator">=</span> newSource;
    }

    <span class="type"><a href="http://qt.nokia.com/doc/4.7/qstringlist.html">QStringList</a></span> QueryExec<span class="operator">::</span>queries() <span class="keyword">const</span> {
        <span class="keyword">return</span> m_queries;
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>setQueries(<span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qstringlist.html">QStringList</a></span> <span class="operator">&amp;</span>queryList) {
        m_queries <span class="operator">=</span> queryList;
    }

    <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantMap-typedef">QVariantMap</a></span> QueryExec<span class="operator">::</span>valuesToBind() <span class="keyword">const</span> {
        <span class="keyword">return</span> m_bindValues;
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>setValuesToBind(<span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantMap-typedef">QVariantMap</a></span> <span class="operator">&amp;</span>nameValueMap) {
        m_bindValues <span class="operator">=</span> nameValueMap;
    }

    <span class="type">int</span> QueryExec<span class="operator">::</span>times() <span class="keyword">const</span> {
        <span class="keyword">return</span> m_times;
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>setTimes(<span class="type">int</span> times) {
        m_times <span class="operator">=</span> times;
    }

    <span class="type">int</span> QueryExec<span class="operator">::</span>interval() <span class="keyword">const</span> {
        <span class="keyword">return</span> m_interval;
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>setInterval(<span class="type">int</span> interval) {
        m_interval <span class="operator">=</span> interval;
    }

    <span class="comment">/**********************************************************
      *Query execution methods.
     */</span>
    <span class="type">void</span> QueryExec<span class="operator">::</span>execute() {
        <span class="comment">// Create an AsyncDataAccess to establish a connection thread to a db</span>
        <span class="comment">// and process multiple queries during the life of the application.</span>
        <span class="keyword">if</span> (m_asyncSql <span class="operator">=</span><span class="operator">=</span> NULL) {
            <span class="comment">// A) Establish connection thread to database</span>
            QueryWorker <span class="operator">*</span>qw <span class="operator">=</span> <span class="keyword">new</span> QueryWorker(m_source<span class="operator">,</span> NULL);
            m_asyncSql <span class="operator">=</span> <span class="keyword">new</span> bb<span class="operator">::</span>data<span class="operator">::</span>AsyncDataAccess(qw<span class="operator">,</span> <span class="keyword">this</span>);

            <span class="comment">// B) Use signals and slots to get results data when it's ready</span>
            <span class="type">bool</span> res <span class="operator">=</span> connect(m_asyncSql<span class="operator">,</span> SIGNAL(reply(<span class="keyword">const</span> bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessReply<span class="operator">&amp;</span>))<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> SLOT(processResult(<span class="keyword">const</span> bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessReply<span class="operator">&amp;</span>)));
            Q_ASSERT(res); <span class="comment">// check connection in debug mode</span>
            Q_UNUSED(res); <span class="comment">// not used in release mode</span>
        }

        <span class="comment">// execute queries the first time</span>
        m_executionCount <span class="operator">=</span> <span class="number">0</span>;
        executeQueries();

        <span class="comment">// If m_times param indicates we wish to execute multiple times</span>
        <span class="comment">// then setup a timer to do that.</span>
        <span class="keyword">if</span> (m_timer <span class="operator">=</span><span class="operator">=</span> NULL <span class="operator">&amp;</span><span class="operator">&amp;</span> <span class="number">1</span> <span class="operator">&lt;</span> m_times) {
            m_timer <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qtimer.html">QTimer</a></span>(<span class="keyword">this</span>);
            <span class="type">bool</span> res <span class="operator">=</span> connect(m_timer<span class="operator">,</span> SIGNAL(timeout())<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> SLOT(executeQueries()));
            Q_ASSERT(res); <span class="comment">// check connection in debug mode</span>
            Q_UNUSED(res); <span class="comment">// not used in release mode</span>
            m_timer<span class="operator">-</span><span class="operator">&gt;</span>start(m_interval);
        }
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>stop() {
        m_executionCount <span class="operator">=</span> <span class="number">0</span>;
        <span class="keyword">if</span> (m_timer <span class="operator">!</span><span class="operator">=</span> NULL) {
            m_timer<span class="operator">-</span><span class="operator">&gt;</span>stop();
            m_timer <span class="operator">=</span> NULL;
        }
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>executeQueries() {
        <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qDebug">qDebug</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;QueryExec executeQueries()&quot;</span>;
        <span class="comment">// validate</span>
        <span class="keyword">if</span> (m_source<span class="operator">.</span>isEmpty()) {
            Q_EMIT error(bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessErrorType<span class="operator">::</span>SourceNotFound<span class="operator">,</span> <span class="string">&quot;Mandatory source property not defined&quot;</span>);
        }
        <span class="keyword">else</span> <span class="keyword">if</span> (m_queries<span class="operator">.</span>isEmpty()) {
            Q_EMIT error(bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessErrorType<span class="operator">::</span>OperationFailure<span class="operator">,</span> <span class="string">&quot;Mandatory queries property not defined&quot;</span>);
        }
        <span class="keyword">else</span> <span class="keyword">if</span> (m_times <span class="operator">&lt;</span><span class="operator">=</span> m_executionCount) {
            stop();
        }
        <span class="keyword">else</span> {
            <span class="comment">// execute</span>
            <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantMap-typedef">QVariantMap</a></span> queriesAndValues;
            queriesAndValues<span class="operator">[</span>QUERIES_KEY<span class="operator">]</span> <span class="operator">=</span> m_queries;
            queriesAndValues<span class="operator">[</span>VALUES_KEY<span class="operator">]</span> <span class="operator">=</span> m_bindValues;
            m_asyncSql<span class="operator">-</span><span class="operator">&gt;</span>execute(queriesAndValues);
        }
    }

    <span class="type">void</span> QueryExec<span class="operator">::</span>processResult(<span class="keyword">const</span> bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessReply <span class="operator">&amp;</span>reply) {
        <span class="operator">+</span><span class="operator">+</span>m_executionCount;
        <span class="comment">//qDebug() &lt;&lt; &quot;QueryExec processResult: reply=&quot; &lt;&lt; reply &lt;&lt; &quot;,m_executionCount=&quot; &lt;&lt; m_executionCount;</span>
        <span class="keyword">if</span> (reply<span class="operator">.</span>hasError()) {
            <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qWarning">qWarning</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;Error while retrieving data from SQL database: &quot;</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> reply;
            Q_EMIT error(reply<span class="operator">.</span>errorType()<span class="operator">,</span> reply<span class="operator">.</span>errorMessage());
        }
        <span class="keyword">else</span> {
            Q_EMIT executed(reply<span class="operator">.</span>result());
        }
    }

    <span class="comment">/******************************************************************************
      *A QueryWorker that can perform a list of queries in a secondary thread
      *managed by SqlConnection.
     */</span>
    QueryWorker<span class="operator">::</span>QueryWorker(<span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>source<span class="operator">,</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qobject.html">QObject</a></span> <span class="operator">*</span>parent)
            : AsyncWorker(parent)<span class="operator">,</span> m_source(source) {
    }

    QueryWorker<span class="operator">::</span><span class="operator">~</span>QueryWorker() {
        <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qDebug">qDebug</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;QueryWorker destructor&quot;</span>;
    }

    <span class="type">void</span> QueryWorker<span class="operator">::</span>execute(<span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span> <span class="operator">&amp;</span>command<span class="operator">,</span> bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessReply <span class="operator">*</span>replyData) {
        <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qDebug">qDebug</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;QueryWorker::execute&quot;</span>;
        <span class="comment">// get the open db connection and start a transaction</span>
        bb<span class="operator">::</span>cascades<span class="operator">::</span>datamanager<span class="operator">::</span>SqlQueryUtils squ;
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlerror.html">QSqlError</a></span> error;
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqldatabase.html">QSqlDatabase</a></span> connection <span class="operator">=</span> squ<span class="operator">.</span>connection(m_source<span class="operator">,</span> <span class="operator">&amp;</span>error);
        <span class="keyword">if</span> (error<span class="operator">.</span>type() <span class="operator">!</span><span class="operator">=</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlerror.html">QSqlError</a></span><span class="operator">::</span>NoError) {
            populateReply(<span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span>()<span class="operator">,</span> error<span class="operator">,</span> replyData);
            <span class="keyword">return</span>;
        }
        connection<span class="operator">.</span>transaction();

        <span class="comment">// command includes a list of queries and a value bindings map</span>
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantMap-typedef">QVariantMap</a></span> queriesAndValues <span class="operator">=</span> command<span class="operator">.</span>toMap();
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qstringlist.html">QStringList</a></span> queries <span class="operator">=</span> queriesAndValues<span class="operator">[</span>QUERIES_KEY<span class="operator">]</span><span class="operator">.</span>toStringList();
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantMap-typedef">QVariantMap</a></span> bindingValues <span class="operator">=</span> queriesAndValues<span class="operator">[</span>VALUES_KEY<span class="operator">]</span><span class="operator">.</span>toMap();

        <span class="comment">// execute the queries</span>
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantList-typedef">QVariantList</a></span> combinedResults;
        <span class="keyword">for</span> (<span class="type">int</span> i<span class="operator">=</span><span class="number">0</span>; i <span class="operator">&lt;</span> queries<span class="operator">.</span>size(); <span class="operator">+</span><span class="operator">+</span>i) {
            <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qDebug">qDebug</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;executing query:  &quot;</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> queries<span class="operator">[</span>i<span class="operator">]</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;, bindings: &quot;</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> bindingValues;
            <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlquery.html">QSqlQuery</a></span> sqlQuery(connection);
            squ<span class="operator">.</span>prepareQuery(queries<span class="operator">[</span>i<span class="operator">]</span><span class="operator">,</span> bindingValues<span class="operator">,</span> <span class="operator">&amp;</span>sqlQuery);
            <span class="keyword">if</span> (<span class="operator">!</span>sqlQuery<span class="operator">.</span>exec()) {
                populateReply(<span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span>()<span class="operator">,</span> sqlQuery<span class="operator">.</span>lastError()<span class="operator">,</span> replyData);
                connection<span class="operator">.</span>rollback();
                <span class="keyword">return</span>;
            }
            populateQueryResults(sqlQuery<span class="operator">,</span> <span class="operator">&amp;</span>combinedResults);
        }

        <span class="keyword">if</span> (connection<span class="operator">.</span>commit()) {
            populateReply(combinedResults<span class="operator">,</span> error<span class="operator">,</span> replyData);
        }
        <span class="keyword">else</span> {
            <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qWarning">qWarning</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;Could not commit transaction for database &quot;</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> connection<span class="operator">.</span>databaseName();
            populateReply(<span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span>()<span class="operator">,</span> connection<span class="operator">.</span>lastError()<span class="operator">,</span> replyData);
            connection<span class="operator">.</span>rollback();
        }
    }

    <span class="type">void</span> QueryWorker<span class="operator">::</span>populateQueryResults(<span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlquery.html">QSqlQuery</a></span> <span class="operator">&amp;</span>sqlQuery<span class="operator">,</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantList-typedef">QVariantList</a></span> <span class="operator">*</span>results) {
        <span class="type"><a href="http://qt.nokia.com/doc/4.7/qlist.html">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="http://qt.nokia.com/doc/4.7/qstring.html">QString</a></span><span class="operator">&gt;</span> field;
        <span class="keyword">while</span> (sqlQuery<span class="operator">.</span>next()) {
            <span class="comment">// get the field names</span>
            <span class="keyword">if</span> (field<span class="operator">.</span>isEmpty()) {
                <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlrecord.html">QSqlRecord</a></span> record <span class="operator">=</span> sqlQuery<span class="operator">.</span>record();
                <span class="keyword">for</span> (<span class="type">int</span> i <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> n <span class="operator">=</span> record<span class="operator">.</span>count(); i <span class="operator">&lt;</span> n; i<span class="operator">+</span><span class="operator">+</span>) {
                    field<span class="operator">.</span>append(record<span class="operator">.</span>fieldName(i));
                }
            }

            <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html#QVariantMap-typedef">QVariantMap</a></span> recordMap;
            <span class="keyword">for</span> (<span class="type">int</span> i <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> n <span class="operator">=</span> field<span class="operator">.</span>size(); i <span class="operator">&lt;</span> n; i<span class="operator">+</span><span class="operator">+</span>) {
                <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span> value <span class="operator">=</span> sqlQuery<span class="operator">.</span>value(i);
                <span class="comment">// JavaScript/QML doesn't support 64bit integers (everything is converted to double)</span>
                <span class="comment">// so convert to string here to make sure we don't run into trouble.</span>
                <span class="comment">// In the long term it will be cleaner to move this code into something like a</span>
                <span class="comment">// query decorator instead of the core query code.</span>
                <span class="keyword">if</span> (value<span class="operator">.</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span><span class="operator">::</span>LongLong <span class="operator">|</span><span class="operator">|</span> value<span class="operator">.</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span><span class="operator">::</span>ULongLong) {
                    value <span class="operator">=</span> value<span class="operator">.</span>toString();
                }
                recordMap<span class="operator">.</span>insert(field<span class="operator">.</span>at(i)<span class="operator">,</span> value);
            }
            results<span class="operator">-</span><span class="operator">&gt;</span>append(recordMap);
        }
    }

    <span class="type">void</span> QueryWorker<span class="operator">::</span>populateReply(<span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qvariant.html">QVariant</a></span> <span class="operator">&amp;</span>result<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlerror.html">QSqlError</a></span> <span class="operator">&amp;</span>error<span class="operator">,</span> bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessReply <span class="operator">*</span>replyData) {
        <span class="comment">// build and return reply</span>
        <span class="keyword">if</span> (error<span class="operator">.</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="http://qt.nokia.com/doc/4.7/qsqlerror.html">QSqlError</a></span><span class="operator">::</span>NoError) {
            replyData<span class="operator">-</span><span class="operator">&gt;</span>setResult(result);
        }
        <span class="keyword">else</span> {
            replyData<span class="operator">-</span><span class="operator">&gt;</span>setError(bb<span class="operator">::</span>data<span class="operator">::</span>DataAccessErrorType<span class="operator">::</span>OperationFailure<span class="operator">,</span>  error<span class="operator">.</span>databaseText() <span class="operator">+</span> <span class="string">&quot; / &quot;</span> <span class="operator">+</span> error<span class="operator">.</span>driverText());
        }
        <a href="http://qt.nokia.com/doc/4.7/qtglobal.html#qDebug">qDebug</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;QueryWorker populateReply: replyData=&quot;</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="operator">*</span>replyData;
    }</pre>
</div>
<!-- @@@datamanagerusage/src/default/QueryExec.cpp -->
  <div class="ft">
    <span></span>
  </div>
</div> 
<div class="footer">
  <p>
     Copyright 2012 Research In Motion Limited.
  <br />
    This document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
    Free Documentation License version 1.3</a>
    as published by the Free Software Foundation.</p>
</div>
</body>
</html>
